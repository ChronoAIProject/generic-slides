{
  "slides": [
    {
      "headline": "第9周\n汇报",
      "highlights": [
        { "label": "Soul Garden 上线", "status": "✓" },
        { "label": "CRDT Lite 同步", "status": "✓" },
        { "label": "Riteset 预审批", "status": "✓" },
        { "label": "Flutter 概念验证", "status": "✓" },
        { "label": "应用内追踪", "status": "→" },
        { "label": "Tolt 集成", "status": "→" }
      ]
    },
    {
      "headline": "Soul Garden\n上线",
      "columns": [
        {
          "title": "已上线",
          "body": "• 修复 Soul Garden 漏洞并稳定上线\n• 将数据架构更新为 CRDT Lite 结构\n• 解决上线后的问题与热修复"
        },
        {
          "title": "待办",
          "body": "• v2 更新计划于第10周\n• 编制完整的 iOS 提交清单\n• iOS 小组件\n• 将 Web 版转为完整 RN"
        }
      ]
    },
    {
      "headline": "CRDT Lite\n状态树",
      "body": "一个面向 50–100 个应用的可复用同步架构。数据模型经历了三个阶段的演化：\n\n1. 单一 KV — 所有状态存放在一个 JSON 大对象中。简单，但无法合并或局部更新。\n2. 数据树 — 嵌套结构，组织更好，但耦合度高，难以独立同步各部分。\n3. 嵌套实体映射 — 当前设计。每条数据是一个扁平实体，携带通用 data 载荷，按类型分组以实现 O(1) 访问。\n\n同步层只负责存储和传输实体，不检查其内容。每个应用定义自己的数据结构。实体使用 refs 表达关系而非嵌套，支持软删除与级联，以及 position 字段排序。当前使用一个共享数据库集合，未来可按实体类型拆分 — 协议不变，无需迁移。",
      "image": {
        "src": "/assets/decks/wk9-26/full-entity-ss.png",
        "alt": "CRDT Lite 完整实体状态树",
        "caption": "图1. 初始状态树 — 实体按类型分组在嵌套 EntityMap 中"
      }
    },
    {
      "headline": "CRDT Lite\n传输载荷",
      "body": "两层架构构建在同一基础之上 — 相同的实体模型、传输格式、存储查询、验证逻辑和 Mongo 模式。仅网络层不同。\n\nTier 1（POC）：按实体 PUT/PATCH，通过 MongoDB $set 实现字段级合并。轮询或 SSE 支持多设备。前端约 100 行，后端约 80 行。数小时内上线，可永久满足大多数应用需求。\n\nTier 2（完整同步）：批量 POST /sync，带 localSeq 冲突检测、增量响应、脏数据集管理、离线队列和 beacon 恢复。前端约 300 行，后端约 150 行。数天内上线。\n\n决策规则：每个应用从 Tier 1 开始。仅当应用展现真实用户牵引力且需要离线支持或批量写入时，才升级到 Tier 2。Tier 1 并非妥协 — 其字段级 PATCH 合并在大多数多设备场景下实际优于 Tier 2 的实体级 last-write-wins。",
      "image": {
        "src": "/assets/decks/wk9-26/payload-ss.png",
        "alt": "CRDT Lite 传输载荷",
        "caption": "图2. 传输载荷 — 同步请求/响应使用相同的 EntityMap 格式"
      }
    },
    {
      "headline": "Riteset\n预审批",
      "columns": [
        {
          "title": "已完成",
          "body": "• 身份验证集成已接入\n• RevenueCat 前端集成完成"
        },
        {
          "title": "第10周",
          "body": "• 目前仅有前端\n• 添加后端集成\n• 实现真正的 AI 功能"
        }
      ]
    },
    {
      "headline": "Flutter\n概念验证",
      "columns": [
        {
          "title": "优势",
          "body": "+ 统一、无缝的跨平台集成\n+ 快速迭代 — Web === iOS === Android\n+ 无需转换或翻译，完全原生应用"
        },
        {
          "title": "注意事项",
          "body": "- 目前手动读写 Flutter 代码的能力有限\n- 当前阶段为纯氛围编程\n- 生态系统不如 Swift 和 React Native (Expo) 成熟"
        }
      ]
    },
    {
      "headline": "进行中",
      "columns": [
        {
          "title": "n8n 集成",
          "body": "• 应用追踪自动化进行中\n• 连接后将填充每周应用指标"
        },
        {
          "title": "PostHog",
          "body": "• 应用内产品分析集成\n• 追踪用户行为和功能采用情况"
        },
        {
          "title": "Tolt",
          "body": "• iOS 应用链接追踪进行中\n• 归因和推荐分析"
        }
      ]
    },
    {
      "headline": "下周见"
    }
  ]
}
